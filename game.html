<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta Tags -->
  <title>Play So Long Sucker - AI Negotiation Game</title>
  <meta name="title" content="Play So Long Sucker - AI Negotiation Game">
  <meta name="description" content="Play the classic 1950 board game by John Nash. A 4-player strategy game where betrayal is mathematically required to win. Features AI opponents powered by LLMs.">
  <meta name="keywords" content="board game, strategy game, John Nash, game theory, negotiation, AI game, multiplayer game, betrayal game">
  <meta name="author" content="lout33">
  <meta name="robots" content="index, follow">

  <!-- Favicon - SVG with emoji for simplicity -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ²</text></svg>">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ²</text></svg>">

  <!-- Theme Color -->
  <meta name="theme-color" content="#1a1a2e">
  <meta name="msapplication-TileColor" content="#1a1a2e">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://so-long-sucker.vercel.app/">
  <meta property="og:title" content="So Long Sucker - The Game of Negotiation & Betrayal">
  <meta property="og:description" content="Play the classic 1950 board game by John Nash. A 4-player strategy game where betrayal is mathematically required to win.">
  <meta property="og:image" content="https://so-long-sucker.vercel.app/og-image.svg">
  <meta property="og:site_name" content="So Long Sucker">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://so-long-sucker.vercel.app/">
  <meta name="twitter:title" content="So Long Sucker - The Game of Negotiation & Betrayal">
  <meta name="twitter:description" content="Play the classic 1950 board game by John Nash. A 4-player strategy game where betrayal is mathematically required to win.">
  <meta name="twitter:image" content="https://so-long-sucker.vercel.app/og-image.svg">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://so-long-sucker.vercel.app/">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "So Long Sucker",
    "description": "A 4-player negotiation and betrayal board game created by John Nash in 1950. Play against AI opponents powered by LLMs.",
    "url": "https://so-long-sucker.vercel.app/",
    "applicationCategory": "GameApplication",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "John Nash",
      "description": "Nobel Prize-winning mathematician and game theorist"
    },
    "dateCreated": "1950",
    "keywords": ["board game", "strategy", "game theory", "negotiation", "AI"]
  }
  </script>
</head>
<body>
  <!-- Grain overlay -->
  <div class="grain-overlay"></div>

  <!-- Navigation -->
  <nav id="main-nav">
    <a href="index.html" class="nav-brand">So Long Sucker</a>
    <div class="nav-links">
      <a href="index.html#leaderboard" class="nav-link">Leaderboard</a>
      <a href="index.html#insights" class="nav-link">Insights</a>
    </div>
  </nav>

  <!-- Setup Screen -->
  <div id="setup-screen">
    <!-- Mode Selection -->
    <div class="setup-content">
      <div id="mode-selection" class="mode-selection">
        <div class="mode-card" id="mode-play">
          <div class="mode-icon">&#127922;</div>
          <h3>Play Game</h3>
          <p>Human vs AI mix<br>Interactive play</p>
          <button class="btn btn-primary btn-mode">Start Setup</button>
        </div>
        <div class="mode-card" id="mode-simulate">
          <div class="mode-icon">&#128300;</div>
          <h3>Simulation Mode</h3>
          <p>Watch AI vs AI games<br>Collect statistics</p>
          <button class="btn btn-secondary btn-mode">Configure</button>
        </div>
      </div>

      <!-- Play Game Setup (existing) -->
      <div id="play-setup" class="setup-body hidden">
        <button class="btn btn-back" id="back-to-modes">&larr; Back</button>

        <div class="setup-section">
          <h2><span class="section-number">01</span>Players</h2>
          <div class="player-grid">
            <div class="player-setup-card" data-color="red">
              <div class="player-chip-display red"></div>
              <span class="player-color-name">Red</span>
              <select id="player-0-type" class="player-type-select">
                <option value="human">Human</option>
                <option value="ai">AI</option>
              </select>
            </div>
            <div class="player-setup-card" data-color="blue">
              <div class="player-chip-display blue"></div>
              <span class="player-color-name">Blue</span>
              <select id="player-1-type" class="player-type-select">
                <option value="human">Human</option>
                <option value="ai" selected>AI</option>
              </select>
            </div>
            <div class="player-setup-card" data-color="green">
              <div class="player-chip-display green"></div>
              <span class="player-color-name">Green</span>
              <select id="player-2-type" class="player-type-select">
                <option value="human">Human</option>
                <option value="ai" selected>AI</option>
              </select>
            </div>
            <div class="player-setup-card" data-color="yellow">
              <div class="player-chip-display yellow"></div>
              <span class="player-color-name">Yellow</span>
              <select id="player-3-type" class="player-type-select">
                <option value="human">Human</option>
                <option value="ai" selected>AI</option>
              </select>
            </div>
          </div>
        </div>

        <div class="setup-section" id="test-state-config">
          <h2><span class="section-number">02</span>Test Scenario</h2>
          <div class="config-grid">
            <div class="config-field" style="grid-column: 1 / -1;">
              <label>Starting State</label>
              <select id="test-state-select">
                <option value="0">Default - Normal game start</option>
                <option value="1">Red has prisoners (blue, green, yellow)</option>
                <option value="2">Red almost winning</option>
                <option value="3">Donation needed - Blue has no chips</option>
                <option value="4">Capture ready - pile ready to capture</option>
                <option value="5">Late game - only Red and Blue alive</option>
                <option value="6">Choose next player - multiple options</option>
                <option value="7">Multiple piles in play</option>
                <option value="8">Prisoner exchange test</option>
              </select>
            </div>
          </div>
        </div>

        <div class="setup-section" id="ai-config">
          <h2><span class="section-number">03</span>AI Configuration</h2>
          <div class="config-grid">
            <div class="config-field">
              <label>Provider</label>
              <select id="ai-provider">
                <option value="groq:llama-3.3-70b-versatile" selected>Groq - Llama 3.3 70B</option>
                <option value="groq:moonshotai/kimi-k2-instruct-0905">Groq - Kimi K2</option>
                <option value="openai">OpenAI (GPT-4o-mini)</option>
                <option value="claude">Claude (Sonnet)</option>
                <option value="azure-claude">Azure Claude (Opus)</option>
              </select>
            </div>
            <div class="config-field">
              <label>API Key</label>
              <input type="password" id="api-key" placeholder="Enter your API key">
            </div>
            <div class="config-field" id="azure-resource-row">
              <label>Azure Resource</label>
              <input type="text" id="azure-resource" placeholder="Azure resource name">
            </div>
          </div>
          <div class="api-test-row">
            <button id="test-api-btn" class="btn btn-outline">Test Connection</button>
            <span id="test-result" class="test-result"></span>
          </div>
          <p class="api-note">Your credentials are stored locally and never leave your browser.</p>
        </div>

        <div class="setup-footer">
          <button id="continue-game-btn" class="btn btn-secondary">Continue Game</button>
          <button id="start-game-btn" class="btn btn-primary">Start New Game</button>
        </div>
      </div>

      <!-- Simulation Setup (new) -->
      <div id="simulation-setup" class="setup-body hidden">
        <button class="btn btn-back" id="back-to-modes-sim">&larr; Back</button>

        <div class="setup-section">
          <h2><span class="section-number">01</span>Parallel Games</h2>
          <div class="option-buttons" id="parallel-options">
            <button class="option-btn" data-value="1">1</button>
            <button class="option-btn" data-value="2">2</button>
            <button class="option-btn selected" data-value="4">4</button>
            <button class="option-btn" data-value="6">6</button>
            <button class="option-btn" data-value="8">8</button>
          </div>
          <p class="option-hint">Number of games running simultaneously on screen</p>
        </div>

        <div class="setup-section">
          <h2><span class="section-number">02</span>Chips Per Player</h2>
          <div class="option-buttons" id="chips-options">
            <button class="option-btn selected" data-value="3">3</button>
            <button class="option-btn" data-value="5">5</button>
            <button class="option-btn" data-value="7">7</button>
          </div>
          <p class="option-hint">Fewer chips = faster games (3 chips recommended for simulation)</p>
        </div>

        <div class="setup-section">
          <h2><span class="section-number">03</span>AI Configuration</h2>
          <div class="config-grid">
            <div class="config-field">
              <label>Provider</label>
              <select id="sim-ai-provider">
                <option value="groq:llama-3.3-70b-versatile" selected>Groq - Llama 3.3 70B</option>
                <option value="groq:moonshotai/kimi-k2-instruct-0905">Groq - Kimi K2</option>
                <option value="openai">OpenAI (GPT-4o-mini)</option>
                <option value="claude">Claude (Sonnet)</option>
                <option value="azure-claude">Azure Claude (Opus)</option>
              </select>
            </div>
            <div class="config-field">
              <label>API Key</label>
              <input type="password" id="sim-api-key" placeholder="Enter your API key">
            </div>
            <div class="config-field" id="sim-azure-resource-row">
              <label>Azure Resource</label>
              <input type="text" id="sim-azure-resource" placeholder="Azure resource name">
            </div>
          </div>
        </div>

        <div class="setup-footer">
          <button id="start-simulation-btn" class="btn btn-primary">Start Simulation</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game-container" class="hidden">
    <!-- Header -->
    <header id="game-header">
      <div class="header-left">
        <h1>So Long Sucker</h1>
      </div>
      <div class="header-center">
        <div id="turn-indicator"></div>
        <div id="status-message"></div>
      </div>
      <div class="header-right">
        <button id="export-game-btn" class="btn btn-icon" title="Export game">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </button>
        <label class="btn btn-icon" title="Import game">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          <input type="file" id="import-game-input" accept=".json" hidden>
        </label>
      </div>
    </header>

    <!-- Main game area -->
    <main id="game-board">
      <!-- Table (piles + dead box) -->
      <section id="table-area">
        <div id="piles-area">
          <div class="section-header">
            <h2>The Table</h2>
            <button id="new-pile-btn" class="btn btn-small" disabled>+ New Pile</button>
          </div>
          <div id="piles-container"></div>
        </div>

        <div id="dead-box">
          <div class="section-header">
            <h2>Dead Box</h2>
          </div>
          <div id="dead-chips"></div>
        </div>

        <!-- Player panels -->
        <div id="players-area">
          <div class="player-panel" data-player="0">
            <div class="player-indicator red"></div>
            <div class="player-info">
              <div class="player-header">
                <span class="player-name">Red</span>
                <span class="player-status"></span>
              </div>
              <div class="player-chips">
                <div class="chip-row supply">
                  <span class="label">Supply</span>
                  <span class="chips"></span>
                </div>
                <div class="chip-row prisoners">
                  <span class="label">Prisoners</span>
                  <span class="chips"></span>
                </div>
              </div>
            </div>
          </div>

          <div class="player-panel" data-player="1">
            <div class="player-indicator blue"></div>
            <div class="player-info">
              <div class="player-header">
                <span class="player-name">Blue</span>
                <span class="player-status"></span>
              </div>
              <div class="player-chips">
                <div class="chip-row supply">
                  <span class="label">Supply</span>
                  <span class="chips"></span>
                </div>
                <div class="chip-row prisoners">
                  <span class="label">Prisoners</span>
                  <span class="chips"></span>
                </div>
              </div>
            </div>
          </div>

          <div class="player-panel" data-player="2">
            <div class="player-indicator green"></div>
            <div class="player-info">
              <div class="player-header">
                <span class="player-name">Green</span>
                <span class="player-status"></span>
              </div>
              <div class="player-chips">
                <div class="chip-row supply">
                  <span class="label">Supply</span>
                  <span class="chips"></span>
                </div>
                <div class="chip-row prisoners">
                  <span class="label">Prisoners</span>
                  <span class="chips"></span>
                </div>
              </div>
            </div>
          </div>

          <div class="player-panel" data-player="3">
            <div class="player-indicator yellow"></div>
            <div class="player-info">
              <div class="player-header">
                <span class="player-name">Yellow</span>
                <span class="player-status"></span>
              </div>
              <div class="player-chips">
                <div class="chip-row supply">
                  <span class="label">Supply</span>
                  <span class="chips"></span>
                </div>
                <div class="chip-row prisoners">
                  <span class="label">Prisoners</span>
                  <span class="chips"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Negotiation Panel -->
      <section id="negotiation-panel">
        <div class="section-header">
          <h2>Negotiation</h2>
        </div>
        <div id="chat-area">
          <div id="chat-messages"></div>
          <div id="chat-input-area">
            <select id="chat-player-select">
              <option value="0">Red</option>
              <option value="1">Blue</option>
              <option value="2">Green</option>
              <option value="3">Yellow</option>
            </select>
            <input type="text" id="chat-input" placeholder="Send a message...">
            <button id="chat-send-btn" class="btn btn-send">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="22" y1="2" x2="11" y2="13"/>
                <polygon points="22 2 15 22 11 13 2 9 22 2"/>
              </svg>
            </button>
          </div>
          <button id="give-prisoner-btn" class="btn btn-outline btn-full">Transfer Prisoner</button>
        </div>
      </section>
    </main>

    <!-- Modals -->
    <div id="donation-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-icon">?</div>
        <h2>Donation Request</h2>
        <p id="donation-message"></p>
        <div id="donation-options" class="modal-options"></div>
      </div>
    </div>

    <div id="next-player-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-icon">&rarr;</div>
        <h2>Choose Next Player</h2>
        <p>Who plays next?</p>
        <div id="next-player-options" class="modal-options"></div>
      </div>
    </div>

    <div id="capture-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-icon">!</div>
        <h2>Capture!</h2>
        <p>Choose a chip to eliminate:</p>
        <div id="capture-chips" class="modal-chips"></div>
      </div>
    </div>

    <div id="game-over-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-icon crown">&#9813;</div>
        <h2>Game Over</h2>
        <p id="winner-message"></p>
        <button id="restart-btn" class="btn btn-primary">Play Again</button>
      </div>
    </div>

    <div id="give-prisoner-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h2>Transfer Prisoner</h2>
        <div class="trade-form">
          <div class="trade-row">
            <label>From</label>
            <select id="give-from">
              <option value="0">Red</option>
              <option value="1">Blue</option>
              <option value="2">Green</option>
              <option value="3">Yellow</option>
            </select>
          </div>
          <div class="trade-row">
            <label>Select prisoner</label>
            <div id="give-prisoner-chips" class="prisoner-chips-grid"></div>
          </div>
          <div class="trade-row">
            <label>To</label>
            <select id="give-to">
              <option value="0">Red</option>
              <option value="1">Blue</option>
              <option value="2">Green</option>
              <option value="3">Yellow</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button id="give-cancel-btn" class="btn btn-outline">Cancel</button>
          <button id="give-confirm-btn" class="btn btn-primary" disabled>Transfer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Simulation Screen -->
  <div id="simulation-container" class="hidden">
    <header id="sim-header">
      <div class="header-left">
        <h1>Simulation Mode</h1>
      </div>
      <div class="header-center">
        <div id="sim-status">Running...</div>
        <div id="sim-progress">0 / 4 games complete</div>
      </div>
      <div class="header-right">
        <button id="sim-stop-btn" class="btn btn-outline">Stop</button>
        <button id="sim-restart-btn" class="btn btn-secondary">Run Again</button>
        <button id="sim-export-btn" class="btn btn-icon" title="Export logs">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </button>
        <button id="sim-back-btn" class="btn btn-icon" title="Back to setup">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"/>
            <polyline points="12 19 5 12 12 5"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Simulation Grid - adapts to 1, 2, 4, 6, or 8 games -->
    <div id="simulation-grid" class="simulation-grid cols-2">
      <!-- Mini game slots will be dynamically created -->
    </div>

    <!-- Stats Panel (shown when all complete) -->
    <div id="sim-stats-panel" class="hidden">
      <h2>Results</h2>
      <div id="sim-stats-content"></div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>

  <!-- Footer -->
  <footer id="app-footer">
    <a href="https://github.com/lout33" target="_blank" rel="noopener">
      Built by lout33
    </a>
  </footer>
</body>
</html>
